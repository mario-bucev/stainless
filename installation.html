<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Installing Stainless &mdash; Stainless 0.8.1 documentation</title>
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Verifying and Compiling Examples" href="gettingstarted.html" />
    <link rel="prev" title="Introduction" href="intro.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Stainless
          </a>
              <div class="version">
                0.8
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div>
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Main">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Installing Stainless</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#general-requirement">General Requirement</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-code-with-stainless-dependencies">Running Code with Stainless dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="#use-standalone-release-recommended">Use Standalone Release (recommended)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#via-docker">Via Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="#usage-with-sbt">Usage With Sbt</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sbt-template-project">Sbt Template Project</a></li>
<li class="toctree-l3"><a class="reference internal" href="#usage-within-an-existing-project">Usage Within An Existing Project</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#external-solver-binaries">External Solver Binaries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#install-z3-4-8-12-linux-macos">Install Z3 4.8.12 (Linux &amp; macOS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#install-cvc-1-8-linux">Install CVC 1.8 (Linux)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#install-cvc-1-6-macos">Install CVC 1.6 (macOS)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#build-from-source-on-linux-macos">Build from Source on Linux &amp; macOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#build-from-source-on-windows-10">Build from Source on Windows 10</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-tests">Running Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="#building-stainless-documentation">Building Stainless Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-ides-with-no-colors-option-emacs-illustration">Using IDEs with –no-colors option. Emacs illustration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gettingstarted.html">Verifying and Compiling Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial: Sorting</a></li>
<li class="toctree-l1"><a class="reference internal" href="options.html">Specifying Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="verification.html">Verification conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="laws.html">Specifying Algebraic Properties</a></li>
<li class="toctree-l1"><a class="reference internal" href="imperative.html">Imperative</a></li>
<li class="toctree-l1"><a class="reference internal" href="ghost.html">Ghost Context</a></li>
<li class="toctree-l1"><a class="reference internal" href="wrap.html">Working With Existing Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="purescala.html">Pure Scala</a></li>
<li class="toctree-l1"><a class="reference internal" href="library.html">Stainless Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="genc.html">Generating C Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="neon.html">Proving Theorems</a></li>
<li class="toctree-l1"><a class="reference internal" href="limitations.html">Limitations of Verification</a></li>
<li class="toctree-l1"><a class="reference internal" href="casestudies.html">Case Studies</a></li>
<li class="toctree-l1"><a class="reference internal" href="coq.html">Translation from Stainless to Coq</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="internals.html">Stainless’ Internals</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" aria-label="Top" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Stainless</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          

<div role="navigation" aria-label="Breadcrumbs">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Installing Stainless</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/installation.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="installing-stainless">
<span id="installation"></span><h1>Installing Stainless<a class="headerlink" href="#installing-stainless" title="Permalink to this headline">¶</a></h1>
<div class="section" id="general-requirement">
<span id="requirements"></span><h2>General Requirement<a class="headerlink" href="#general-requirement" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Java 8 JRE
It suffices to have headless OpenJDK JRE 8 (e.g. one that one gets with <code class="docutils literal notranslate"><span class="pre">apt</span> <span class="pre">install</span> <span class="pre">openjdk-8-jre-headless</span></code> on Debian/Ubuntu).
Make sure that <code class="docutils literal notranslate"><span class="pre">java</span> <span class="pre">-version</span></code> reports a version starting with 1.8, such as <code class="docutils literal notranslate"><span class="pre">openjdk</span> <span class="pre">version</span> <span class="pre">&quot;1.8</span></code> or <code class="docutils literal notranslate"><span class="pre">java</span> <span class="pre">version</span> <span class="pre">&quot;1.8</span></code>.</p></li>
</ul>
</div>
<div class="section" id="running-code-with-stainless-dependencies">
<span id="running-code"></span><h2>Running Code with Stainless dependencies<a class="headerlink" href="#running-code-with-stainless-dependencies" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>Clone the sources from <a class="reference external" href="https://github.com/epfl-lara/stainless">https://github.com/epfl-lara/stainless</a></p></li>
<li><p>Create a folder to put compiled Scala objects: <code class="docutils literal notranslate"><span class="pre">mkdir</span> <span class="pre">-p</span> <span class="pre">~/.scala_objects</span></code></p></li>
<li><p>Compile your code (here in <code class="docutils literal notranslate"><span class="pre">MyFile.scala</span></code>, though you can have more than one file) while referring to the Stainless library sources: <code class="docutils literal notranslate"><span class="pre">scalac</span> <span class="pre">-d</span> <span class="pre">~/.scala_objects</span> <span class="pre">$(find</span> <span class="pre">/path/to/Stainless/frontends/library/stainless/</span> <span class="pre">-name</span> <span class="pre">&quot;*.scala&quot;)</span> <span class="pre">MyFile.scala</span></code></p></li>
<li><p>Run your code (replace <code class="docutils literal notranslate"><span class="pre">MyMainClass</span></code> with the name of your main object): <code class="docutils literal notranslate"><span class="pre">scala</span> <span class="pre">-cp</span> <span class="pre">~/.scala_objects</span> <span class="pre">MyMainClass</span></code></p></li>
</ol>
</div>
<div class="section" id="use-standalone-release-recommended">
<span id="standalone-release"></span><h2>Use Standalone Release (recommended)<a class="headerlink" href="#use-standalone-release-recommended" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>Download the latest Stainless release from the <a class="reference external" href="https://github.com/epfl-lara/stainless/releases">Releases page on GitHub</a>, under the <strong>Assets</strong> section. Make sure to pick the appropriate ZIP for your operating system. This release is bundled with Z3 4.8.12.</p></li>
<li><p>Unzip the the file you just downloaded to a directory.</p></li>
<li><p>(Optional) Add this directory to your <code class="docutils literal notranslate"><span class="pre">PATH</span></code>. This will let you invoke Stainless via the <code class="docutils literal notranslate"><span class="pre">stainless</span></code> command instead of its fully qualified path in step 5.</p></li>
<li><p>Paste the following code in a file named <code class="docutils literal notranslate"><span class="pre">test.scala</span></code>:</p></li>
</ol>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="nn">stainless.lang._</span>

<span class="k">object</span> <span class="nc">test</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">ok</span> <span class="o">=</span> <span class="o">{</span>
    <span class="n">assert</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>In a terminal, type the following command, substituting the proper path to the directory where you unzipped the latest release:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ /path/to/unzipped/directory/stainless test.scala
</pre></div>
</div>
<ol class="arabic simple" start="6">
<li><p>The output should read:</p></li>
</ol>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[Warning ] The Z3 native interface is not available. Falling back onto smt-z3.
[  Info  ]  - Checking cache: &#39;body assertion&#39; VC for ok @5:7...
[  Info  ] Cache miss: &#39;body assertion&#39; VC for ok @5:7...
[  Info  ]  - Now solving &#39;body assertion&#39; VC for ok @5:7...
[  Info  ]  - Result for &#39;body assertion&#39; VC for ok @5:7:
[  Info  ]  =&gt; VALID
[  Info  ]   ┌───────────────────┐
[  Info  ] ╔═╡ stainless summary ╞══════════════════════════════════════════════════════════════════════╗
[  Info  ] ║ └───────────────────┘                                                                      ║
[  Info  ] ║ ok   body assertion           valid     U:smt-z3        test.scala:5:7           0.239     ║
[  Info  ] ╟┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄┄╢
[  Info  ] ║ total: 1    valid: 1    (0 from cache) invalid: 0    unknown: 0    time:   0.239           ║
[  Info  ] ╚════════════════════════════════════════════════════════════════════════════════════════════╝
[  Info  ] Shutting down executor service.
</pre></div>
</div>
<p>Note: If the warning above says something about falling back on the Princess solver, you might be missing the <code class="docutils literal notranslate"><span class="pre">libgomp1</span></code> library,
which you can install with your favorite package manager. For example, on Debian/Ubuntu, just run <code class="docutils literal notranslate"><span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">libgomp1</span></code>.</p>
</div>
<div class="section" id="via-docker">
<span id="id1"></span><h2>Via Docker<a class="headerlink" href="#via-docker" title="Permalink to this headline">¶</a></h2>
<p>If you have <a class="reference external" href="https://docs.docker.com">Docker</a> installed, you can run the latest Stainless version with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ docker run -v <span class="s2">&quot;</span><span class="nv">$PWD</span><span class="s2">:/local&quot;</span> epfllara/stainless:latest /local/test.scala
</pre></div>
</div>
<p>This will pull down the latest Stainless image from <a class="reference external" href="https://hub.docker.com/r/epfllara/stainless">Docker Hub</a>, mount the current directory at <code class="docutils literal notranslate"><span class="pre">/local</span></code> within the container, and invoke Stainless on <code class="docutils literal notranslate"><span class="pre">test.scala</span></code>, provided it exists in the current directory. See the previous section for a sample <code class="docutils literal notranslate"><span class="pre">test.scala</span></code>.</p>
</div>
<div class="section" id="usage-with-sbt">
<span id="sbt-usage"></span><h2>Usage With Sbt<a class="headerlink" href="#usage-with-sbt" title="Permalink to this headline">¶</a></h2>
<p>Stainless is also avaiable as a sbt plugin, which hooks into the build process to verify
your code on compilation. This allows for both verifying your code, compiling, and running your
code in one swift motion.</p>
<p>Moreover, thanks to <a class="reference external" href="https://scalameta.org/metals/">Metals</a>, Stainless diagnostics will
automatically appear in your editor of choice (we recommend <a class="reference external" href="https://code.visualstudio.com">VS Code</a>),
while the full log will typically be available in a separate window/pane.
To this end, please follow the installation instructions for your editor on
the <a class="reference external" href="https://scalameta.org/metals/docs/editors/overview.html">Metals website</a>.</p>
<p>To ease the process, we provide a template for a Stainless-enabled sbt project
which one can then import into their editor of choice to get started in a few steps:
<a class="reference internal" href="#gitter8-template"><span class="std std-ref">Sbt Template Project</span></a></p>
<p>Alternatively, one can also integrate Stainless into an existing sbt project: <a class="reference internal" href="#sbt-project"><span class="std std-ref">Usage Within An Existing Project</span></a>.</p>
<div class="section" id="sbt-template-project">
<span id="gitter8-template"></span><h3>Sbt Template Project<a class="headerlink" href="#sbt-template-project" title="Permalink to this headline">¶</a></h3>
<p><strong>Install sbt:</strong></p>
<p>Follow the instructions at <a class="reference external" href="http://www.scala-sbt.org/">http://www.scala-sbt.org/</a> to install <code class="docutils literal notranslate"><span class="pre">sbt</span></code> 1.3.0.</p>
<p><strong>Create a new project from the template:</strong></p>
<ol class="arabic">
<li><p>In a console, create a new project with the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sbt new epfl-lara/stainless-project.g8
</pre></div>
</div>
</li>
<li><p>Fill in a name for your project, eg. <code class="docutils literal notranslate"><span class="pre">My</span> <span class="pre">Great</span> <span class="pre">Project</span></code>.</p></li>
<li><p>Leave the proposed Stainless version as is, ie, just press <code class="docutils literal notranslate"><span class="pre">ENTER</span></code>.</p></li>
<li><p>sbt will now create a project under <code class="docutils literal notranslate"><span class="pre">./my-great-project</span></code>.</p></li>
<li><p>Put the source files you want to verify under <code class="docutils literal notranslate"><span class="pre">verified/src/main/scala/</span></code> and your regular Scala code under <code class="docutils literal notranslate"><span class="pre">core/src/main/scala/</span></code>.</p></li>
<li><p>Launch <code class="docutils literal notranslate"><span class="pre">sbt</span></code> and, at its prompt, type the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&gt; core/run
</pre></div>
</div>
<p>This will compile, verify, and run your code!</p>
</li>
<li><p>To only compile and verify your code, you can use the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&gt; verified/run
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="usage-within-an-existing-project">
<span id="sbt-project"></span><h3>Usage Within An Existing Project<a class="headerlink" href="#usage-within-an-existing-project" title="Permalink to this headline">¶</a></h3>
<p>Stainless can also be used within an existing sbt 1.3.0 project.</p>
<ol class="arabic simple">
<li><p>Start by installing an external solver (see Section “<a class="reference internal" href="#smt-solvers"><span class="std std-ref">External Solver Binaries</span></a>”).</p></li>
<li><p>Add the <code class="docutils literal notranslate"><span class="pre">sbt-stainless</span></code> plugin together with the required resolver to your <code class="docutils literal notranslate"><span class="pre">project/plugins.sbt</span></code></p></li>
</ol>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">resolvers</span> <span class="o">++=</span> <span class="nc">Seq</span><span class="o">(</span>
  <span class="nc">Resolver</span><span class="o">.</span><span class="n">bintrayRepo</span><span class="o">(</span><span class="s">&quot;epfl-lara&quot;</span><span class="o">,</span> <span class="s">&quot;princess&quot;</span><span class="o">),</span>
  <span class="nc">Resolver</span><span class="o">.</span><span class="n">bintrayIvyRepo</span><span class="o">(</span><span class="s">&quot;epfl-lara&quot;</span><span class="o">,</span> <span class="s">&quot;sbt-plugins&quot;</span><span class="o">),</span>
  <span class="o">(</span><span class="s">&quot;uuverifiers&quot;</span> <span class="n">at</span> <span class="s">&quot;http://logicrunch.research.it.uu.se/maven&quot;</span><span class="o">).</span><span class="n">withAllowInsecureProtocol</span><span class="o">(</span><span class="kc">true</span><span class="o">),</span>
<span class="o">)</span>

<span class="n">addSbtPlugin</span><span class="o">(</span><span class="s">&quot;ch.epfl.lara&quot;</span> <span class="o">%</span> <span class="s">&quot;sbt-stainless&quot;</span> <span class="o">%</span> <span class="s">&quot;&lt;insert-version&gt;&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>Check the <a class="reference external" href="https://github.com/epfl-lara/stainless/releases">GitHub releases</a> or the <a class="reference external" href="https://bintray.com/epfl-lara/sbt-plugins/sbt-stainless">sbt-stainless bintray repository</a> for the available versions.</p>
<ol class="arabic simple" start="3">
<li><p>In your project’s build file, enable the <code class="docutils literal notranslate"><span class="pre">StainlessPlugin</span></code> on the modules that should be verified by Stainless. Below is an example:</p></li>
</ol>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="c1">// build.sbt</span>
<span class="k">lazy</span> <span class="k">val</span> <span class="n">algorithm</span> <span class="o">=</span> <span class="n">project</span>
  <span class="o">.</span><span class="n">in</span><span class="o">(</span><span class="n">file</span><span class="o">(</span><span class="s">&quot;algorithm&quot;</span><span class="o">))</span>
  <span class="o">.</span><span class="n">enablePlugins</span><span class="o">(</span><span class="nc">StainlessPlugin</span><span class="o">)</span> <span class="c1">// &lt;-- Enabling Stainless verification on this module!</span>
  <span class="o">.</span><span class="n">settings</span><span class="o">(...)</span>
</pre></div>
</div>
<p>Note that if you are using <code class="docutils literal notranslate"><span class="pre">.scala</span></code> build files you need to use the fully qualified name <code class="docutils literal notranslate"><span class="pre">ch.epfl.lara.sbt.stainless.StainlessPlugin</span></code>. Also, because stainless accepts a subset of the Scala language, you may need to refactor your build a bit and code to successfully use Stainless on a module.</p>
<ol class="arabic simple" start="4">
<li><p>After modifying the build, type <code class="docutils literal notranslate"><span class="pre">reload</span></code> if inside the sbt interactive shell. From now on, when executing <code class="docutils literal notranslate"><span class="pre">compile</span></code> on a module where the <code class="docutils literal notranslate"><span class="pre">StainlessPlugin</span></code> is enabled, Stainless will check your Scala code and report errors in the shell (just like any other error that would be reported during compilation).</p></li>
</ol>
<p>That’s all there is to it. However, the <code class="docutils literal notranslate"><span class="pre">sbt-stainless</span></code> plugin is a more recent addition to Stainless compared to command-line script. It has seen less testing in the field and currently has the following limitations:</p>
<ul class="simple">
<li><p>No incremental compilation support. All sources (included the stainless-library sources) are recompiled at every <code class="docutils literal notranslate"><span class="pre">compile</span></code> execution.ub</p></li>
<li><p>The plugin <em>does not</em> support Scala 3 (dotty). To track sbt support in dotty you can follow <a class="reference external" href="https://github.com/epfl-lara/stainless/issues/178">issue #178</a>.</p></li>
</ul>
<p>Also, note that the plugin offers a <code class="docutils literal notranslate"><span class="pre">stainlessEnabled</span></code> setting that can help experimenting with Stainless. The <code class="docutils literal notranslate"><span class="pre">stainlessEnabled</span></code> setting is set to <code class="docutils literal notranslate"><span class="pre">true</span></code> by default, but you can flip the flag to false by typing <code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">every</span> <span class="pre">stainlessEnabled</span> <span class="pre">:=</span> <span class="pre">false</span></code> while inside the sbt interactive shell.</p>
<ol class="arabic simple" start="5">
<li><p>It is possible to specify extra source dependencies to be added to the set of files processed by Stainless via the <code class="docutils literal notranslate"><span class="pre">stainlessExtraDeps</span></code> setting. For example, to add both the <code class="docutils literal notranslate"><span class="pre">stainless-algebra</span></code> and <code class="docutils literal notranslate"><span class="pre">stainless-actors</span></code> packages, along with the latter’s dependency on Akka,
one can add the following settings to their build:</p></li>
</ol>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">stainlessExtraDeps</span> <span class="o">++=</span> <span class="nc">Seq</span><span class="o">(</span>
  <span class="s">&quot;ch.epfl.lara&quot;</span> <span class="o">%%</span> <span class="s">&quot;stainless-algebra&quot;</span> <span class="o">%</span> <span class="s">&quot;0.1.2&quot;</span><span class="o">,</span>
  <span class="s">&quot;ch.epfl.lara&quot;</span> <span class="o">%%</span> <span class="s">&quot;stainless-actors&quot;</span>  <span class="o">%</span> <span class="s">&quot;0.1.1&quot;</span><span class="o">,</span>
<span class="o">)</span>

<span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="s">&quot;com.typesafe.akka&quot;</span> <span class="o">%%</span> <span class="s">&quot;akka-actor&quot;</span> <span class="o">%</span> <span class="s">&quot;2.5.21&quot;</span>
</pre></div>
</div>
<p>Note that the dependencies specified in <code class="docutils literal notranslate"><span class="pre">stainlessExtraDeps</span></code> must be available as a source JAR from any of the resolvers configured in the build.</p>
</div>
</div>
<div class="section" id="external-solver-binaries">
<span id="smt-solvers"></span><h2>External Solver Binaries<a class="headerlink" href="#external-solver-binaries" title="Permalink to this headline">¶</a></h2>
<p>If no external SMT solvers (such as Z3 or CVC4) are found, Stainless will use the bundled Scala-based <a class="reference external" href="http://www.philipp.ruemmer.org/princess.shtml">Princess solver</a></p>
<p>To improve performance, we highly recommend that you install the following two additional external SMT solvers as binaries for your platform:</p>
<ul class="simple">
<li><p>CVC4 1.8, <a class="reference external" href="http://cvc4.cs.stanford.edu">http://cvc4.cs.stanford.edu</a></p></li>
<li><p>Z3 4.8.12, <a class="reference external" href="https://github.com/Z3Prover/z3">https://github.com/Z3Prover/z3</a></p></li>
</ul>
<p>You can enable these solvers using <code class="docutils literal notranslate"><span class="pre">--solvers=smt-z3</span></code> and <code class="docutils literal notranslate"><span class="pre">--solvers=smt-cvc4</span></code> flags.</p>
<p>Solver binaries that you install should match your operating system and your architecture. We recommend that you install these solvers as a binary and have their binaries available in the <code class="docutils literal notranslate"><span class="pre">$PATH</span></code> (as <code class="docutils literal notranslate"><span class="pre">z3</span></code> or <code class="docutils literal notranslate"><span class="pre">cvc4</span></code>).</p>
<p>Note that somewhat lower version numbers of solvers should work as well and might even have different sets of soundness-related issues.</p>
<p>You can use multiple solvers in portfolio mode, as with the options <code class="docutils literal notranslate"><span class="pre">--timeout=15</span> <span class="pre">--solvers=smt-z3,smt-cvc4</span></code>, where verification succeeds if at least one of the solvers proves (within the given number of seconds) each the verification conditions. We suggest to order the solvers starting from the one most likely to succeed quickly.</p>
<p>For final verification runs of highly critical software, we recommend that (instead of the portfolio mode) you obtain several solvers and their versions, then try a single solver at a time and ensure that each verification run succeeds (thus applying N-version programming to SMT solver implementations).</p>
<div class="section" id="install-z3-4-8-12-linux-macos">
<h3>Install Z3 4.8.12 (Linux &amp; macOS)<a class="headerlink" href="#install-z3-4-8-12-linux-macos" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p>Download Z3 4.8.12 from <a class="reference external" href="https://github.com/Z3Prover/z3/releases/tag/z3-4.8.12">https://github.com/Z3Prover/z3/releases/tag/z3-4.8.12</a></p></li>
<li><p>Unzip the downloaded archive</p></li>
<li><p>Copy the <code class="docutils literal notranslate"><span class="pre">z3</span></code> binary found in the <code class="docutils literal notranslate"><span class="pre">bin/</span></code> directory of the inflated archive to a directory in your <code class="docutils literal notranslate"><span class="pre">$PATH</span></code>, eg., <code class="docutils literal notranslate"><span class="pre">/usr/local/bin</span></code>.</p></li>
<li><p>Make sure <code class="docutils literal notranslate"><span class="pre">z3</span></code> can be found, by opening a new terminal window and typing:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ z3 --version
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>The output should read:</p></li>
</ol>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Z3 version 4.8.12 - 64 bit`
</pre></div>
</div>
</div>
<div class="section" id="install-cvc-1-8-linux">
<h3>Install CVC 1.8 (Linux)<a class="headerlink" href="#install-cvc-1-8-linux" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p>Download CVC4 1.8 from <a class="reference external" href="http://cvc4.cs.stanford.edu/downloads/builds/x86_64-linux-opt/">http://cvc4.cs.stanford.edu/downloads/builds/x86_64-linux-opt/</a> (reachable from <a class="reference external" href="https://cvc4.github.io/">https://cvc4.github.io/</a> )</p></li>
<li><p>Copy or link the downloaded binary under name <code class="docutils literal notranslate"><span class="pre">cvc4</span></code> to a directory in your <code class="docutils literal notranslate"><span class="pre">$PATH</span></code>, eg., <code class="docutils literal notranslate"><span class="pre">/usr/local/bin</span></code>.</p></li>
</ol>
<ol class="arabic simple" start="4">
<li><p>Make sure <code class="docutils literal notranslate"><span class="pre">cvc4</span></code> can be found, by opening a new terminal window and typing:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ cvc4 --version <span class="p">|</span> head
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>The output should begin with:</p></li>
</ol>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>This is CVC4 version 1.8
</pre></div>
</div>
</div>
<div class="section" id="install-cvc-1-6-macos">
<h3>Install CVC 1.6 (macOS)<a class="headerlink" href="#install-cvc-1-6-macos" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p>Install <a class="reference external" href="https://brew.sh">Homebrew</a></p></li>
<li><p>Install CVC4 using the Homebrew tap at <a class="reference external" href="https://github.com/CVC4/homebrew-cvc4">https://github.com/CVC4/homebrew-cvc4</a></p></li>
<li><p>Make sure <code class="docutils literal notranslate"><span class="pre">cvc4</span></code> can be found, by opening a new terminal window and typing:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ cvc4 --version
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>The output should begin with:</p></li>
</ol>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>This is CVC4 version 1.6
</pre></div>
</div>
</div>
</div>
<div class="section" id="build-from-source-on-linux-macos">
<h2>Build from Source on Linux &amp; macOS<a class="headerlink" href="#build-from-source-on-linux-macos" title="Permalink to this headline">¶</a></h2>
<p>To build Stainless, we use <code class="docutils literal notranslate"><span class="pre">sbt</span></code>. In a typical configuration, <code class="docutils literal notranslate"><span class="pre">sbt</span> <span class="pre">universal:stage</span></code> in the root of the source tree should work, yet,
in an attempt to be more reproducible and independent from sbt cache and path, the instructions below assume that the directory called <code class="docutils literal notranslate"><span class="pre">stainless</span></code> does not exist, they instruct <code class="docutils literal notranslate"><span class="pre">sbt</span></code> to use a relative path for its bootstrap, and do not require adding <code class="docutils literal notranslate"><span class="pre">sbt</span></code> to your path.</p>
<p><strong>Install sbt</strong></p>
<p>Follow the instructions at <a class="reference external" href="http://www.scala-sbt.org/">http://www.scala-sbt.org/</a> to install <code class="docutils literal notranslate"><span class="pre">sbt</span></code> 1.3.0.</p>
<p><strong>Check out sources</strong></p>
<p>Get the sources of Stainless by cloning the official Stainless repository:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ git clone https://github.com/epfl-lara/stainless.git
Cloning into <span class="s1">&#39;stainless&#39;</span>...
</pre></div>
</div>
<p><strong>Run sbt</strong></p>
<p>The following instructions will invoke sbt while using a stainless sub-directory to download files.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> stainless
$ sbt universal:stage
</pre></div>
</div>
<p><strong>Where to find generated files</strong></p>
<p>The compilation will automatically generate the bash script <code class="docutils literal notranslate"><span class="pre">frontends/scalac/target/universal/stage/bin/stainless-scalac</span></code> that uses the <code class="docutils literal notranslate"><span class="pre">scalac</span></code> compiler as frontend.</p>
<p>You may want to introduce a soft-link from <code class="docutils literal notranslate"><span class="pre">frontends/scalac/target/universal/stage/bin/stainless-scalac</span></code> to a file called <code class="docutils literal notranslate"><span class="pre">stainless</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ln -s frontends/scalac/target/universal/stage/bin/stainless-scalac stainless
</pre></div>
</div>
<p>Analogous scripts work for various platforms and allow additional control over the execution, such as passing JVM arguments or system properties:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ frontends/scalac/target/universal/stage/bin/stainless-scalac -Dscalaz3.debug.load<span class="o">=</span><span class="nb">true</span> -J-Xmx6G --help
</pre></div>
</div>
<p>Note that Stainless is organized as a structure of several projects. The main project lives in <code class="docutils literal notranslate"><span class="pre">core</span></code> while the two available frontends can be found in <code class="docutils literal notranslate"><span class="pre">frontends/scalac</span></code> and <code class="docutils literal notranslate"><span class="pre">frontends/dotty</span></code>.  From a user point of view, this should most of the time be transparent and the build command should take care of everything.</p>
</div>
<div class="section" id="build-from-source-on-windows-10">
<h2>Build from Source on Windows 10<a class="headerlink" href="#build-from-source-on-windows-10" title="Permalink to this headline">¶</a></h2>
<p>Before following the infrequently updated instructions in this section, considering running Ubuntu on Windows 10 and following the instructions for Linux.</p>
<p>Get the sources of Stainless by cloning the official Stainless repository. You will need a Git shell for windows, e.g.  <a class="reference external" href="https://git-for-windows.github.io/">Git for Windows</a>.
On Windows, please do not use <code class="docutils literal notranslate"><span class="pre">sbt</span> <span class="pre">universal:stage</span></code> as this generates a Windows batch file which is unusable, because it contains commands that are too long for Windows.
Instead, please use <code class="docutils literal notranslate"><span class="pre">sbt</span> <span class="pre">stainless-scalac-standalone/assembly</span></code> as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ git clone https://github.com/epfl-lara/stainless.git
Cloning into <span class="s1">&#39;stainless&#39;</span>...
// ...
$ <span class="nb">cd</span> stainless
$ sbt stainless-scalac-standalone/assembly
// takes about <span class="m">1</span> minutes
</pre></div>
</div>
<p>Running Stainless can then be done with the command: <code class="docutils literal notranslate"><span class="pre">java</span> <span class="pre">-jar</span> <span class="pre">frontends\stainless-scalac-standalone\target\scala-2.12\stainless-scalac-standalone-{VERSION}.jar</span></code>, where <code class="docutils literal notranslate"><span class="pre">VERSION</span></code> denotes Stainless version.</p>
</div>
<div class="section" id="running-tests">
<h2>Running Tests<a class="headerlink" href="#running-tests" title="Permalink to this headline">¶</a></h2>
<p>Stainless comes with a test suite. Use the following commands to
invoke different test suites:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ sbt <span class="nb">test</span>
$ sbt it:test
</pre></div>
</div>
<p>It’s also possible to run tests in isolation, for example, the following command runs <code class="docutils literal notranslate"><span class="pre">Extraction</span></code> tests on all files in <code class="docutils literal notranslate"><span class="pre">termination/looping</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ sbt <span class="s1">&#39;it:testOnly *ExtractionSuite* -- -z &quot;in termination/looping&quot;&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="building-stainless-documentation">
<h2>Building Stainless Documentation<a class="headerlink" href="#building-stainless-documentation" title="Permalink to this headline">¶</a></h2>
<p>Stainless documentation is available at <a class="reference external" href="https://epfl-lara.github.io/stainless/">https://epfl-lara.github.io/stainless/</a> .
To build the documentation locally, you will need Sphinx (
<a class="reference external" href="http://sphinx-doc.org/">http://sphinx-doc.org/</a> ), a restructured text toolkit that
was originally developed to support Python documentation.</p>
<ul class="simple">
<li><p>On Ubuntu 18, you can use <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">apt</span> <span class="pre">install</span> <span class="pre">sphinx-common</span></code></p></li>
</ul>
<p>The documentation resides in the <code class="docutils literal notranslate"><span class="pre">core/src/sphinx/</span></code> directory and can be built using the provided <code class="docutils literal notranslate"><span class="pre">Makefile</span></code>. To do this, in a Linux shell,
type <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">html</span></code>, and open in your web browser the generated top-level local HTML file, by default stored in
<code class="docutils literal notranslate"><span class="pre">core/src/sphinx/_build/html/index.html</span></code>. Also, you can open the <code class="docutils literal notranslate"><span class="pre">*.rst</span></code> documentation files in a text editor, as they are human-readable in their source form as well.</p>
<p>Note for project maintainers: to build documentation on GitHub Pages, use <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">gh-pages</span></code> in the same Makefile, or adapt it to you needs.</p>
</div>
<div class="section" id="using-ides-with-no-colors-option-emacs-illustration">
<h2>Using IDEs with –no-colors option. Emacs illustration<a class="headerlink" href="#using-ides-with-no-colors-option-emacs-illustration" title="Permalink to this headline">¶</a></h2>
<p>Using command line option <code class="docutils literal notranslate"><span class="pre">--no-colors</span></code> asks stainless to produce clear 7-bit ASCII output with error messages in a standardized format:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>FileName.scala:LineNo:ColNo: text of the error message
</pre></div>
</div>
<p>This helps IDEs to pick up line numbers and show error location in the source file.</p>
<p>In <code class="docutils literal notranslate"><span class="pre">emacs</span></code> editor, you can invoke <code class="docutils literal notranslate"><span class="pre">ansi-term</span></code> and <code class="docutils literal notranslate"><span class="pre">compilation-shell-minor-mode</span></code>. Then, run</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>stainless --no-colors &lt;InputFilesAndOptions&gt;
</pre></div>
</div>
<p>You may also consider using the <code class="docutils literal notranslate"><span class="pre">--watch</span></code> option.</p>
<p>You should now be able to click on a message for verification condition to jump to the appropriate position in the appropriate file, as well as to use emacs commands <code class="docutils literal notranslate"><span class="pre">previous-error</span></code> and <code class="docutils literal notranslate"><span class="pre">next-error</span></code> to navigate through errors and other verification-condition outcomes.</p>
<p>Here is a very simple illustration that introduces an interactive <code class="docutils literal notranslate"><span class="pre">comp-ansi-term</span></code> command that creates new window with ansi-term and minor compilation mode:</p>
<div class="highlight-lisp notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">setq</span> <span class="nv">comp-terminal-current-number</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">(</span><span class="nb">defun</span> <span class="nv">create-numbered-comp-terminal</span> <span class="p">()</span>
  <span class="p">(</span><span class="nv">ansi-term</span> <span class="s">&quot;/bin/bash&quot;</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">rename-buffer</span> <span class="p">(</span><span class="nv">concat</span> <span class="s">&quot;q&quot;</span> <span class="p">(</span><span class="nv">number-to-string</span> <span class="nv">comp-terminal-current-number</span><span class="p">))</span> <span class="mi">1</span><span class="p">)</span>
  <span class="p">(</span><span class="k">setq</span> <span class="nv">comp-terminal-current-number</span> <span class="p">(</span><span class="nb">+</span> <span class="nv">comp-terminal-current-number</span> <span class="mi">1</span><span class="p">))</span>
  <span class="p">(</span><span class="nv">compilation-shell-minor-mode</span><span class="p">)</span>
<span class="p">)</span>
<span class="p">(</span><span class="nb">defun</span> <span class="nv">comp-ansi-term</span> <span class="p">(</span><span class="nv">arg</span><span class="p">)</span>
  <span class="s">&quot;Run ansi-term with bash and compilation-shell-minor-mode in buffer named q_N for increasing N&quot;</span> <span class="p">(</span><span class="nv">interactive</span> <span class="s">&quot;P&quot;</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">create-numbered-comp-terminal</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">split-window-vertically</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">previous-buffer</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">other-window</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The following globally binds the above command to the F3 key and binds F7 and F8 to commands for navigating reports:</p>
<div class="highlight-lisp notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nv">global-set-key</span> <span class="nv">[f3]</span> <span class="ss">&#39;comp-ansi-term</span><span class="p">)</span>
<span class="p">(</span><span class="nv">global-set-key</span> <span class="nv">[f7]</span> <span class="ss">&#39;previous-error</span><span class="p">)</span>
<span class="p">(</span><span class="nv">global-set-key</span> <span class="nv">[f8]</span> <span class="ss">&#39;next-error</span><span class="p">)</span>
</pre></div>
</div>
<p>For more information, please consult the documentation for <code class="docutils literal notranslate"><span class="pre">emacs</span></code>.</p>
</div>
</div>


           </div>
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="intro.html" class="btn btn-neutral float-left" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="gettingstarted.html" class="btn btn-neutral float-right" title="Verifying and Compiling Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2009-2019 EPFL, Lausanne.
      <span class="lastupdated">Last updated on Aug 16, 2021.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>